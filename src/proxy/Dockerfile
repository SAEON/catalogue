FROM node:17.7.1

ARG ELASTICSEARCH_ADDRESS=http://localhost:9200
ENV ELASTICSEARCH_ADDRESS=$ELASTICSEARCH_ADDRESS

WORKDIR /app
COPY . .
RUN npm ci --force --only=production
EXPOSE 8001 8002

CMD ELASTICSEARCH_ADDRESS=$ELASTICSEARCH_ADDRESS npm run start:prod